(window.webpackJsonp=window.webpackJsonp||[]).push([[2],[,,,,,,function(t,e,a){},function(t,e,a){},function(t,e,a){},function(t,e,a){},,,,,,function(t,e){t.exports=jQuery},,,,,,,,,function(t,e,a){"use strict";var i=a(6);a.n(i).a},function(t,e,a){"use strict";var i=a(7);a.n(i).a},function(t,e,a){"use strict";var i=a(8);a.n(i).a},function(t,e,a){"use strict";var i=a(9);a.n(i).a},,function(t,e,a){},,,function(t,e,a){"use strict";a.r(e);var i=a(2),s={name:"App"},n=a(0),r=Object(n.a)(s,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"vue-backend-app"}},[e("router-view")],1)}),[],!1,null,null,null).exports,o=a(13),l=a(10);const d=jQuery;var c=class{getUrl(){return WEB_GLOBAL_JS_VARIABLES.res_url+"goship/v1"}getByQuery(t=[],e=null,a=null){d.ajax({url:this.getUrl(),type:"GET",data:t,beforeSend:function(t){t.setRequestHeader("X-WP-Nonce",WEB_GLOBAL_JS_VARIABLES.nonce)},success:function(t,a,i){e&&e(t,a,i)},error:function(t){a&&a(t)}})}getDetail(t,e=[],a=null,i=null){d.ajax({url:this.getUrl()+"/"+t,type:"GET",data:e,beforeSend:function(t){t.setRequestHeader("X-WP-Nonce",WEB_GLOBAL_JS_VARIABLES.nonce)},success:function(t,e,i){a&&a(t,e,i)},error:function(t){i&&i(t)}})}create(t=[],e=null,a=null){d.ajax({url:this.getUrl(),type:"POST",data:t,beforeSend:function(t){t.setRequestHeader("X-WP-Nonce",WEB_GLOBAL_JS_VARIABLES.nonce)},success:function(t,a,i){e&&e(t,a,i)},error:function(t){a&&a(t)}})}delete(t,e=[],a=null,i=null){d.ajax({url:this.getUrl()+"/"+t,type:"delete",data:e,beforeSend:function(t){t.setRequestHeader("X-WP-Nonce",WEB_GLOBAL_JS_VARIABLES.nonce)},success:function(t,e,i){a&&a(t,e,i)},error:function(t){i&&i(t)}})}update(t,e,a=null,i=null){d.ajax({url:this.getUrl()+"/"+t,type:"PUT",data:e,beforeSend:function(t){t.setRequestHeader("X-WP-Nonce",WEB_GLOBAL_JS_VARIABLES.nonce)},success:function(t,e,i){a&&a(t,e,i)},error:function(t){i&&i(t)}})}};const u=jQuery;var _=new class extends c{getUrl(){return WEB_GLOBAL_JS_VARIABLES.res_url+"wc/v3/orders"}getGoshipInfo(t,e=[],a=null,i=null){u.ajax({url:WEB_GLOBAL_JS_VARIABLES.res_url+"goship/v1/orders/"+t,type:"GET",data:e,beforeSend:function(t){t.setRequestHeader("X-WP-Nonce",WEB_GLOBAL_JS_VARIABLES.nonce)},success:function(t,e,i){a&&a(t,e,i)},error:function(t){i&&i(t)}})}};const p=jQuery;var v=new class extends c{getUrl(){return super.getUrl()+"/shipments"}getRates(t=[],e=null,a=null){p.ajax({url:WEB_GLOBAL_JS_VARIABLES.res_url+"goship/v1/rates",type:"POST",data:t,beforeSend:function(t){t.setRequestHeader("X-WP-Nonce",WEB_GLOBAL_JS_VARIABLES.nonce)},success:function(t,a,i){e&&e(t,a,i)},error:function(t){a&&a(t)}})}printShipment(t,e=[],a=null,i=null){p.ajax({url:this.getUrl()+"/"+t+"/print",type:"GET",data:e,beforeSend:function(t){t.setRequestHeader("X-WP-Nonce",WEB_GLOBAL_JS_VARIABLES.nonce)},success:function(t,e,i){a&&a(t,e,i)},error:function(t){i&&i(t)}})}};const h=jQuery;var m=new class{cities(t,e=null){h.ajax({url:WEB_GLOBAL_JS_VARIABLES.res_url+"goship/v1/cities",type:"GET",success:function(e){t(e)},error:function(t){e&&e(t)}})}districts(t,e,a=null){h.ajax({url:WEB_GLOBAL_JS_VARIABLES.res_url+"goship/v1/districts/"+t,type:"GET",success:function(t){e(t)},error:function(t){a&&a(t)}})}wards(t,e,a=null){h.ajax({url:WEB_GLOBAL_JS_VARIABLES.res_url+"goship/v1/wards/"+t,type:"GET",success:function(t){e(t)},error:function(t){a&&a(t)}})}};var f=new class extends c{getUrl(){return super.getUrl()+"/pickups"}};const g=jQuery;var y={name:"Select2",props:["options","value"],template:"#select2-template",mounted:function(){var t=this;g(this.$el).select2({data:this.options}).val(this.value).trigger("change").on("change",(function(){t.$emit("input",this.value)}))},watch:{value:function(t){g(this.$el).val(t).trigger("change")},options:function(t){g(this.$el).empty().select2({data:t})}},destroyed:function(){g(this.$el).off().select2("destroy")}},b=Object(n.a)(y,(function(){var t=this.$createElement;return(this._self._c||t)("select",[this._t("default")],2)}),[],!1,null,null,null).exports,w=a(1),C=a(3),x=a(11);Object(w.c)("required",C.b),Object(w.c)("numeric",C.a),Object(w.d)("vi",x);const k={rate:"",from_city:"",from_district:"",from_ward:"",from_street:"",sender_name:"",sender_phone:"",to_city:"",to_district:"",to_ward:"",to_street:"",receiver_name:"",receiver_phone:"",cod:0,amount:0,weight:500,payer:0,package_name:"test package",metadata:"ghi chú",order_id:"",node_code:"KHONGCHOXEMHANG",length:0,width:0,height:0,pickup_id:""};var S={name:"PickupForm",props:[],components:{Select2:b,ValidationProvider:w.b,ValidationObserver:w.a},data:()=>({data:{...k},pickups:[],toCities:[],toDistricts:[],toWards:[],rates:[],loadRates:!1,delayLoadRates:500}),methods:{async submit(){await this.$refs.observer.validate()?(this.data.to_city_name=this.$refs.to_city.options[this.$refs.to_city.selectedIndex].text,this.data.to_district_name=this.$refs.to_district.options[this.$refs.to_district.selectedIndex].text,this.data.to_ward_name=this.$refs.to_ward.options[this.$refs.to_ward.selectedIndex].text,this.$emit("success",this.data)):alert("Vui lòng kiểm tra thông tin cần nhập!")},loadDistrict(){this.data.to_city?m.districts(this.data.to_city,t=>{this.toDistricts=t}):this.toDistricts=[]},loadCity(){m.cities(t=>{this.toCities=t})},loadWard(){this.data.to_district?(m.wards(this.data.to_district,t=>{this.toWards=t}),this.getRates()):this.toWards=[]},loadPickup(){f.getByQuery({per_page:1e4},t=>{this.pickups=t.data})},changePickup(){if(this.data.pickup_id){let t=this.pickups.reduce((t,e)=>({...t,[e.id]:e}),{})[this.data.pickup_id];this.data.from_city=t.city_code,this.data.from_district=t.district_code,this.data.from_ward=t.ward_id,this.data.from_street=t.street,this.data.sender_name=t.name,this.data.sender_phone=t.phone;let e=t.full_street;e=e.split(","),this.data.from_city_name=e.pop().trim(),this.data.from_district_name=e.pop().trim(),this.data.from_ward_name=e.pop().trim(),this.getRates()}},getRates(){clearTimeout(this.delayLoadRates),this.delayLoadRates=setTimeout(()=>{this.data.from_city&&this.data.from_district&&this.data.to_city&&this.data.to_district&&this.data.weight&&(this.loadRates=!0,v.getRates(this.data,t=>{this.rates=t,this.loadRates=!1}))},500)}},created(){this.loadCity(),this.loadPickup(),this.$on("submit",()=>{this.submit()}),this.$on("init",t=>{t.default=1==t.default,this.data={...t},this.data.to_district&&this.loadDistrict(),this.data.to_district&&this.loadWard(),this.getRates()}),this.$on("reset",()=>{this.data={...k},this.toDistricts=[],this.toWards=[]})}},$=(a(24),Object(n.a)(S,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"pickup-form"},[a("div",{staticClass:"form-wrap"},[a("ValidationObserver",{ref:"observer",scopedSlots:t._u([{key:"default",fn:function(e){e.invalid;var i=e.passes;return[a("form",{staticClass:"validate",on:{submit:function(e){return e.preventDefault(),i(t.submit)}}},[a("div",{staticStyle:{display:"flex"}},[a("div",{staticClass:"receiver-info",staticStyle:{flex:"1"}},[a("div",{staticClass:"form-field"},[a("label",[t._v("Điểm lấy hàng")]),t._v(" "),a("ValidationProvider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.errors;return[a("select",{directives:[{name:"model",rawName:"v-model",value:t.data.pickup_id,expression:"data.pickup_id"}],staticStyle:{width:"100%"},attrs:{name:"Điểm lấy hàng"},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.data,"pickup_id",e.target.multiple?a:a[0])},t.changePickup]}},[a("option",{attrs:{value:""}},[t._v("Chọn điểm lấy hàng")]),t._v(" "),t._l(t.pickups,(function(e){return a("option",{key:e.id,domProps:{value:e.id}},[t._v("\n                    "+t._s(e.shop_name)+"\n                  ")])}))],2),t._v(" "),a("span",{staticClass:"validate-error"},[t._v(t._s(i[0]))])]}}],null,!0)})],1),t._v(" "),a("div",{staticClass:"form-field"},[a("label",[t._v("Người nhận")]),t._v(" "),a("ValidationProvider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.errors;return[a("input",{directives:[{name:"model",rawName:"v-model",value:t.data.receiver_name,expression:"data.receiver_name"}],attrs:{name:"Người nhận",type:"text"},domProps:{value:t.data.receiver_name},on:{input:function(e){e.target.composing||t.$set(t.data,"receiver_name",e.target.value)}}}),t._v(" "),a("span",{staticClass:"validate-error"},[t._v(t._s(i[0]))])]}}],null,!0)})],1),t._v(" "),a("div",{staticClass:"form-field"},[a("label",[t._v("SĐT người nhận")]),t._v(" "),a("ValidationProvider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.errors;return[a("input",{directives:[{name:"model",rawName:"v-model",value:t.data.receiver_phone,expression:"data.receiver_phone"}],attrs:{type:"text",name:"SĐT người nhận"},domProps:{value:t.data.receiver_phone},on:{input:function(e){e.target.composing||t.$set(t.data,"receiver_phone",e.target.value)}}}),t._v(" "),a("span",{staticClass:"validate-error"},[t._v(t._s(i[0]))])]}}],null,!0)})],1),t._v(" "),a("div",{staticClass:"form-field"},[a("label",[t._v("Tỉnh thành đến")]),t._v(" "),a("ValidationProvider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.errors;return[a("select",{directives:[{name:"model",rawName:"v-model",value:t.data.to_city,expression:"data.to_city"}],ref:"to_city",staticStyle:{width:"100%"},attrs:{name:"Tỉnh thành đến"},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.data,"to_city",e.target.multiple?a:a[0])},t.loadDistrict]}},[a("option",{attrs:{value:""}},[t._v("Chọn tỉnh thành")]),t._v(" "),t._l(t.toCities,(function(e){return a("option",{key:e.id,domProps:{value:e.id}},[t._v("\n                    "+t._s(e.name)+"\n                  ")])}))],2),t._v(" "),a("span",{staticClass:"validate-error"},[t._v(t._s(i[0]))])]}}],null,!0)})],1),t._v(" "),a("div",{staticClass:"form-field"},[a("label",[t._v("Quận huyện đến")]),t._v(" "),a("ValidationProvider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.errors;return[a("select",{directives:[{name:"model",rawName:"v-model",value:t.data.to_district,expression:"data.to_district"}],ref:"to_district",staticStyle:{width:"100%"},attrs:{disabled:!t.toDistricts.length,name:"Quận huyện đến"},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.data,"to_district",e.target.multiple?a:a[0])},t.loadWard]}},[a("option",{attrs:{value:""}},[t._v("Chọn quận huyện")]),t._v(" "),t._l(t.toDistricts,(function(e){return a("option",{key:e.id,domProps:{value:e.id}},[t._v("\n                    "+t._s(e.name)+"\n                  ")])}))],2),t._v(" "),a("span",{staticClass:"validate-error"},[t._v(t._s(i[0]))])]}}],null,!0)})],1),t._v(" "),a("div",{staticClass:"form-field"},[a("label",[t._v("Phường xã đến")]),t._v(" "),a("ValidationProvider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.errors;return[a("select",{directives:[{name:"model",rawName:"v-model",value:t.data.to_ward,expression:"data.to_ward"}],ref:"to_ward",staticStyle:{width:"100%"},attrs:{disabled:!t.toWards.length,name:"Phường xã đến"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.data,"to_ward",e.target.multiple?a:a[0])}}},[a("option",{attrs:{value:""}},[t._v("Chọn phường xã")]),t._v(" "),t._l(t.toWards,(function(e){return a("option",{key:e.id,domProps:{value:e.id}},[t._v("\n                    "+t._s(e.name)+"\n                  ")])}))],2),t._v(" "),a("span",{staticClass:"validate-error"},[t._v(t._s(i[0]))])]}}],null,!0)})],1),t._v(" "),a("div",{staticClass:"form-field"},[a("label",[t._v("Địa chỉ đến")]),t._v(" "),a("ValidationProvider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.errors;return[a("input",{directives:[{name:"model",rawName:"v-model",value:t.data.to_street,expression:"data.to_street"}],attrs:{type:"text",name:"Địa chỉ đến"},domProps:{value:t.data.to_street},on:{input:function(e){e.target.composing||t.$set(t.data,"to_street",e.target.value)}}}),t._v(" "),a("span",{staticClass:"validate-error"},[t._v(t._s(i[0]))])]}}],null,!0)})],1)]),t._v(" "),a("div",{staticClass:"package-info",staticStyle:{flex:"1"}},[a("div",{staticClass:"form-field"},[a("label",[t._v("Cân nặng(g)")]),t._v(" "),a("ValidationProvider",{attrs:{rules:"required|numeric"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.errors;return[a("input",{directives:[{name:"model",rawName:"v-model",value:t.data.weight,expression:"data.weight"}],attrs:{name:"Cân nặng",type:"text"},domProps:{value:t.data.weight},on:{change:t.getRates,input:function(e){e.target.composing||t.$set(t.data,"weight",e.target.value)}}}),t._v(" "),a("span",{staticClass:"validate-error"},[t._v(t._s(i[0]))])]}}],null,!0)})],1),t._v(" "),a("div",{staticClass:"form-field"},[a("label",[t._v("Dài x Rộng x Cao (cm)")]),t._v(" "),a("div",{staticStyle:{display:"flex","align-items":"center"}},[a("ValidationProvider",{attrs:{rules:"numeric"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.errors;return[a("input",{directives:[{name:"model",rawName:"v-model",value:t.data.length,expression:"data.length"}],attrs:{type:"text",name:"Dài"},domProps:{value:t.data.length},on:{change:t.getRates,input:function(e){e.target.composing||t.$set(t.data,"length",e.target.value)}}}),t._v(" "),a("span",{staticClass:"validate-error"},[t._v(t._s(i[0]))])]}}],null,!0)}),t._v(" "),a("span",[t._v("x")]),t._v(" "),a("ValidationProvider",{attrs:{rules:"numeric"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.errors;return[a("input",{directives:[{name:"model",rawName:"v-model",value:t.data.width,expression:"data.width"}],attrs:{type:"text",name:"rộng"},domProps:{value:t.data.width},on:{change:t.getRates,input:function(e){e.target.composing||t.$set(t.data,"width",e.target.value)}}}),t._v(" "),a("span",{staticClass:"validate-error"},[t._v(t._s(i[0]))])]}}],null,!0)}),t._v(" "),a("span",[t._v("x")]),t._v(" "),a("ValidationProvider",{attrs:{rules:"numeric"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.errors;return[a("input",{directives:[{name:"model",rawName:"v-model",value:t.data.height,expression:"data.height"}],attrs:{type:"text",name:"cao"},domProps:{value:t.data.height},on:{change:t.getRates,input:function(e){e.target.composing||t.$set(t.data,"height",e.target.value)}}}),t._v(" "),a("span",{staticClass:"validate-error"},[t._v(t._s(i[0]))])]}}],null,!0)})],1)]),t._v(" "),a("div",{staticClass:"form-field"},[a("label",[t._v("Tên hàng hóa")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.data.package_name,expression:"data.package_name"}],attrs:{type:"text"},domProps:{value:t.data.package_name},on:{input:function(e){e.target.composing||t.$set(t.data,"package_name",e.target.value)}}})]),t._v(" "),a("div",{staticClass:"form-field"},[a("label",[t._v("Ghi chú")]),t._v(" "),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.data.metadata,expression:"data.metadata"}],attrs:{rows:"3"},domProps:{value:t.data.metadata},on:{input:function(e){e.target.composing||t.$set(t.data,"metadata",e.target.value)}}})]),t._v(" "),a("div",{staticClass:"form-field"},[a("label",[t._v("COD (đ)")]),t._v(" "),a("ValidationProvider",{attrs:{rules:"numeric"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.errors;return[a("input",{directives:[{name:"model",rawName:"v-model",value:t.data.cod,expression:"data.cod"}],attrs:{type:"text",name:"Tiền thu hộ"},domProps:{value:t.data.cod},on:{change:t.getRates,input:function(e){e.target.composing||t.$set(t.data,"cod",e.target.value)}}}),t._v(" "),a("span",{staticClass:"validate-error"},[t._v(t._s(i[0]))])]}}],null,!0)})],1),t._v(" "),a("div",{staticClass:"form-field"},[a("label",[t._v("Khai giá (đ)")]),t._v(" "),a("ValidationProvider",{attrs:{rules:"numeric"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.errors;return[a("input",{directives:[{name:"model",rawName:"v-model",value:t.data.amount,expression:"data.amount"}],attrs:{type:"text",name:"Giá trị khai giá"},domProps:{value:t.data.amount},on:{change:t.getRates,input:function(e){e.target.composing||t.$set(t.data,"amount",e.target.value)}}}),t._v(" "),a("span",{staticClass:"validate-error"},[t._v(t._s(i[0]))])]}}],null,!0)})],1),t._v(" "),a("div",{staticClass:"form-field"},[a("label",[t._v("Người trả phí")]),t._v(" "),a("ValidationProvider",{attrs:{rules:"required",name:"Người trả phí"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.errors;return[a("input",{directives:[{name:"model",rawName:"v-model",value:t.data.payer,expression:"data.payer"}],attrs:{type:"radio",name:"payer"},domProps:{value:0,checked:t._q(t.data.payer,0)},on:{change:[function(e){return t.$set(t.data,"payer",0)},t.getRates]}}),t._v("\n                Người nhận   \n                "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.data.payer,expression:"data.payer"}],attrs:{type:"radio",name:"payer"},domProps:{value:1,checked:t._q(t.data.payer,1)},on:{change:[function(e){return t.$set(t.data,"payer",1)},t.getRates]}}),t._v("\n                Người gửi\n                "),a("span",{staticClass:"validate-error"},[t._v(t._s(i[0]))])]}}],null,!0)})],1)])]),t._v(" "),a("div",{staticClass:"rate"},[a("div",{staticClass:"rate-header"},[a("div",{staticClass:"select-input"},[t._v(" ")]),t._v(" "),a("label",[a("div",{staticStyle:{width:"40%","text-align":"center"}},[t._v("\n                Hãng vận chuyển\n              ")]),t._v(" "),a("div",{staticStyle:{width:"30%","text-align":"center"}},[t._v("Dịch vụ")]),t._v(" "),a("div",{staticStyle:{width:"30%","text-align":"end"}},[t._v("Tổng phí")])])]),t._v(" "),t.loadRates?a("div",{staticStyle:{display:"flex","align-items":"center",color:"red","justify-content":"center"}},[t._v("\n            Đang tải bảng giá vui lòng đợi...\n          ")]):t._e(),t._v(" "),t.loadRates||t.rates.length?t._e():a("div",{staticStyle:{display:"flex","align-items":"center",color:"red","justify-content":"center"}},[t._v("\n            Không có bảng giá phù hợp với tuyến đường...\n          ")]),t._v(" "),!t.loadRates&&t.rates.length?a("div",[a("ValidationProvider",{attrs:{rules:"required",name:"Đơn vị vận chuyển"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.errors;return[t._l(t.rates,(function(e){return a("div",{key:e.id,staticClass:"rate-item"},[a("div",{staticClass:"select-input"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.data.rate,expression:"data.rate"}],attrs:{type:"radio",name:"rate",id:"rate-"+e.id},domProps:{value:e.id,checked:t._q(t.data.rate,e.id)},on:{change:function(a){return t.$set(t.data,"rate",e.id)}}})]),t._v(" "),a("label",{attrs:{for:"rate-"+e.id}},[a("div",{staticClass:"rate-carrier",staticStyle:{width:"40%","text-align":"center"}},[a("img",{attrs:{width:"65",src:e.carrier_logo,alt:e.carrier_name}}),t._v("\n                     \n                    "+t._s(e.carrier_name)+"\n                  ")]),t._v(" "),a("div",{staticStyle:{width:"30%","text-align":"center"}},[t._v("\n                    "+t._s(e.service)+"\n                  ")]),t._v(" "),a("div",{staticStyle:{width:"30%","text-align":"end",color:"red"}},[t._v("\n                    "+t._s(t.formatCurrency(e.total_fee))+"\n                  ")])])])})),t._v(" "),a("span",{staticClass:"validate-error"},[t._v(t._s(i[0]))])]}}],null,!0)})],1):t._e()])])]}}])})],1)])}),[],!1,null,"655a15af",null).exports),j={name:"detail-shipment",data:()=>({order:{},shipment:{},loadShipment:!1}),methods:{orderMeta:t=>t.meta_data.reduce((t,e)=>({...t,[e.key]:e.value}),{}),fetchShipment(t){this.loadShipment=!0,v.getDetail(t,{},t=>{this.shipment=t,this.loadShipment=!1,console.log(t)})}},created(){this.$on("init",t=>{this.order=t,this.fetchShipment(this.orderMeta(t)._gs_code)})}},E=(a(25),Object(n.a)(j,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"shipment-detail"},[t.loadShipment?a("div",{staticStyle:{height:"500px",display:"flex","justify-content":"center","align-items":"center",color:"red"}},[t._v("\n    Đang tải dư liệu vui lòng đợi...\n  ")]):t._e(),t._v(" "),t.shipment&&t.shipment.id&&!t.loadShipment?a("div",{staticClass:"d-flex justify-content-space-between"},[a("div",{staticClass:"status-history col"},[a("ul",t._l(t.shipment.history.reverse(),(function(e,i){return a("li",{key:i},[a("p",[t._v(t._s(e.updated_at))]),t._v(" "),a("div",[a("p",[t._v(t._s(e.status_text))]),t._v(" "),a("p",[t._v(t._s(e.status_desc))]),t._v(" "),e.message?a("p",[t._v(t._s(e.message))]):t._e()])])})),0),t._v(" "),a("div",[a("h3",{staticClass:"title"},[t._v("Thời gian")]),t._v(" "),a("div",{staticClass:"info-tracking"},[a("div",{staticClass:"d-flex justify-content-space-between"},[t._m(0),t._v(" "),a("div",{},[a("p",[t._v(t._s(t.shipment.created_at))])])]),t._v(" "),a("div",{staticClass:"d-flex justify-content-space-between"},[t._m(1),t._v(" "),a("div",{},[a("p",[t._v(t._s(t.shipment.expected_delivery_date))])])])]),t._v(" "),a("h3",{staticClass:"title"},[t._v("\n          Lưu ý: Đối với những đơn đi huyện, xã, vùng sâu, vùng xa thời gian\n          giao hàng sẽ cộng thêm từ 1-3 ngày\n        ")])])]),t._v(" "),a("div",{staticClass:"shipment-info col",staticStyle:{"flex-grow":"1.8"}},[a("h3",{staticClass:"title"},[t._v("Thông tin vận đơn")]),t._v(" "),a("div",{staticClass:"info-tracking"},[a("div",{staticClass:"d-flex justify-content-space-between"},[t._m(2),t._v(" "),a("div",{},[a("p",[t._v(t._s(t.shipment.carrier_name))])])]),t._v(" "),a("div",{staticClass:"d-flex justify-content-space-between"},[t._m(3),t._v(" "),a("div",{staticClass:"d-flex justify-content-space-between"},[a("p",{staticClass:"text-green"},[t._v(t._s(t.shipment.carrier_code))])])]),t._v(" "),a("div",{staticClass:"d-flex justify-content-space-between"},[t._m(4),t._v(" "),a("div",{},[a("p",{staticClass:"text-green"},[t._v(t._s(t.shipment.id))])])]),t._v(" "),a("div",{staticClass:"d-flex justify-content-space-between"},[t._m(5),t._v(" "),a("div",{},[a("p",[t._v(t._s(t.shipment.service_name))])])]),t._v(" "),a("div",{staticClass:"d-flex justify-content-space-between"},[t._m(6),t._v(" "),a("div",{},[a("p",[t._v(t._s(t.formatCurrency(t.shipment.parcel.cod_amount)))])])]),t._v(" "),a("div",{staticClass:"d-flex justify-content-space-between"},[t._m(7),t._v(" "),a("div",{},[a("p",[t._v(t._s(t.formatCurrency(t.shipment.total_fee)))])])])]),t._v(" "),a("h3",{staticClass:"title"},[t._v("Người gửi")]),t._v(" "),a("div",{staticClass:"info-tracking"},[a("div",{staticClass:"d-flex justify-content-space-between"},[t._m(8),t._v(" "),a("div",{},[a("p",[t._v(t._s(t.shipment.address_from.name))])])]),t._v(" "),a("div",{staticClass:"d-flex justify-content-space-between"},[t._m(9),t._v(" "),a("div",{},[a("p",[t._v(t._s(t.shipment.address_from.phone))])])]),t._v(" "),a("div",{staticClass:"d-flex justify-content-space-between"},[t._m(10),t._v(" "),a("div",{},[a("p",[t._v("\n              "+t._s(t.shipment.address_from.street)+",\n              "+t._s(t.shipment.address_from.ward)+",\n              "+t._s(t.shipment.address_from.district)+",\n              "+t._s(t.shipment.address_from.city)+"\n            ")])])])]),t._v(" "),a("h3",{staticClass:"title"},[t._v("Người nhận")]),t._v(" "),a("div",{staticClass:"info-tracking"},[a("div",{staticClass:"d-flex justify-content-space-between"},[t._m(11),t._v(" "),a("div",{},[a("p",[t._v(t._s(t.shipment.address_to.name))])])]),t._v(" "),a("div",{staticClass:"d-flex justify-content-space-between"},[t._m(12),t._v(" "),a("div",{},[a("p",[t._v(t._s(t.shipment.address_to.phone))])])]),t._v(" "),a("div",{staticClass:"d-flex justify-content-space-between"},[t._m(13),t._v(" "),a("div",{},[a("p",[t._v("\n              "+t._s(t.shipment.address_to.street)+",\n              "+t._s(t.shipment.address_to.ward)+",\n              "+t._s(t.shipment.address_to.district)+",\n              "+t._s(t.shipment.address_to.city)+"\n            ")])])])]),t._v(" "),a("h3",{staticClass:"title"},[t._v("Thông tin hàng hóa")]),t._v(" "),a("div",{staticClass:"info-tracking"},[a("div",{staticClass:"d-flex justify-content-space-between"},[t._m(14),t._v(" "),a("div",{},[a("p",[t._v(t._s(t.shipment.parcel.name))])])]),t._v(" "),a("div",{staticClass:"d-flex justify-content-space-between"},[t._m(15),t._v(" "),a("div",{},[a("p",[t._v(t._s(t.formatNumber(t.shipment.parcel.weight,0))+" g")])])]),t._v(" "),t.shipment.parcel.cweight?a("div",{staticClass:"d-flex justify-content-space-between"},[t._m(16),t._v(" "),a("div",{},[a("p",[t._v(t._s(t.formatNumber(t.shipment.parcel.cweight,0))+" g")])])]):t._e(),t._v(" "),a("div",{staticClass:"d-flex justify-content-space-between"},[t._m(17),t._v(" "),a("div",{staticClass:"d-flex justify-content-space-between"},[a("p",[t._v("\n              "+t._s(t.shipment.parcel.length)+" x "+t._s(t.shipment.parcel.width)+" x\n              "+t._s(t.shipment.parcel.height)+" cm\n            ")])])]),t._v(" "),t.shipment.parcel.metadata?a("div",{staticClass:"d-flex justify-content-space-between"},[t._m(18),t._v(" "),a("div",{},[a("p",[t._v(t._s(t.shipment.parcel.metadata))])])]):t._e()])])]):t._e()])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{},[e("p",{staticClass:"text-bold"},[this._v("Ngày tạo đơn:")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{},[e("p",{staticClass:"text-bold"},[this._v("Dự kiến giao:")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{},[e("p",{staticClass:"text-bold"},[this._v("Hãng vận chuyển:")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{},[e("p",{staticClass:"text-bold"},[this._v("Mã tracking:")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{},[e("p",{staticClass:"text-bold"},[this._v("Mã Goship:")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{},[e("p",{staticClass:"text-bold"},[this._v("Gói dịch vụ:")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{},[e("p",{staticClass:"text-bold"},[this._v("COD:")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{},[e("p",{staticClass:"text-bold"},[this._v("Tổng phí:")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{},[e("p",{staticClass:"text-bold"},[this._v("Tên")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{},[e("p",{staticClass:"text-bold"},[this._v("Điện thoại")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{},[e("p",{staticClass:"text-bold"},[this._v("Địa chỉ")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{},[e("p",{staticClass:"text-bold"},[this._v("Tên")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{},[e("p",{staticClass:"text-bold"},[this._v("Điện thoại")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{},[e("p",{staticClass:"text-bold"},[this._v("Địa chỉ")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{},[e("p",{staticClass:"text-bold"},[this._v("Gói hàng:")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{},[e("p",{staticClass:"text-bold"},[this._v("Cân nặng:")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{},[e("p",{staticClass:"text-bold"},[this._v("Cân nặng quy đổi:")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{},[e("p",{staticClass:"text-bold"},[this._v("Kích thước:")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{},[e("p",{staticClass:"text-bold"},[this._v("Ghi chú:")])])}],!1,null,"0431592a",null).exports),A={name:"orders",components:{ListTable:l.a,SendShipmentForm:$,DetailShipment:E},data:()=>({loading:!1,items:[],current:null,filter:{search:""},pagination:{total:1,items_per_page:25,total_page:1,current_page:1},columns:{id:{label:"Đơn hàng"},ship_address:{label:"Địa chỉ nhận hàng"},date_created:{label:"Ngày gửi đơn"},carrier:{label:"Hãng vận chuyển"},tracking:{label:"Mã"},status:{label:"Trạng thái"},total:{label:"Tổng tiền ship"},action:{label:"Hành động"}},actions:[{key:"edit",label:"Sửa"},{key:"trash",label:"Xóa"}]}),created(){this.filter.search=this.$route.query.search,this.loadItems(),this.$nextTick(()=>{jQuery("#send-shipment-dialog").dialog({dialogClass:"wp-dialog",width:800,modal:!0,autoOpen:!1,closeOnEscape:!0,buttons:{"Gửi đơn":()=>{this.$refs["send-shipment-form"].$emit("submit")},"Đóng":function(){jQuery(this).dialog("close")}}}),jQuery("#shipment-delete-confirm").dialog({dialogClass:"wp-dialog",width:400,modal:!0,autoOpen:!1,closeOnEscape:!0,buttons:{"Hủy":()=>{this.submitDelete(this.current)},"Đóng":function(){jQuery(this).dialog("close")}}}),jQuery("#detail-shipment-dialog").dialog({dialogClass:"wp-dialog",width:1e3,modal:!0,autoOpen:!1,closeOnEscape:!0,buttons:{"Đóng":function(){jQuery(this).dialog("close")}}})})},mounted(){this.jQuery=jQuery},methods:{loadItems(){let t=this;t.loading=!0,_.getByQuery({page:this.pagination.current_page,per_page:this.pagination.items_per_page,...this.filter},(e,a,i)=>{t.loading=!1,t.items=e,t.pagination.total=parseInt(i.getResponseHeader("X-Wp-Total")),t.pagination.total_page=parseInt(i.getResponseHeader("X-Wp-Totalpages")),t.$router.replace({query:{...this.filter,page:t.pagination.current_page}})})},onActionClick(t,e){console.log(t,e)},onBulkAction(t,e){},goToPage(t){this.pagination.current_page=t,this.loadItems()},orderId:t=>`#${t.id} ${t.shipping.first_name} ${t.shipping.last_name} - ${t.shipping.phone?t.shipping.phone:t.billing.phone}`,orderMeta:t=>t.meta_data.reduce((t,e)=>({...t,[e.key]:e.value}),{}),orderShipTo(t){let e=this.orderMeta(t);return[t.shipping.address_1,e._billing_ward_name,e._billing_district_name,e._billing_city_name].filter(Boolean).join(", ")},sendShipment(t){_.getGoshipInfo(t.id,{},t=>{this.$refs["send-shipment-form"].$emit("init",t.shipment),jQuery("#send-shipment-dialog").dialog("open")})},submitSendShipment(t){v.create(t,t=>{jQuery("#send-shipment-dialog").dialog("close"),this.loadItems()})},cancelShipment(t){this.current=t,jQuery("#shipment-delete-confirm").dialog("open")},submitDelete(t){v.delete(t.id,{},()=>{jQuery("#shipment-delete-confirm").dialog("close"),this.loadItems()},t=>{let e=jQuery.parseJSON(t.responseText);alert(e.message)})},detailShipment(t){this.current=t,this.$refs["detail-shipment"].$emit("init",t),this.$nextTick(()=>{jQuery("#detail-shipment-dialog").dialog("open")})},printShipment(t){v.printShipment(this.orderMeta(t)._gs_code,{},t=>{window.open(t.url,"_blank").focus()})}}},P=(a(26),{name:"Home",components:{Order:Object(n.a)(A,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"order"},[a("div",{staticClass:"page-header"},[a("h1",{staticClass:"wp-heading-inline"},[t._v("Goship - Đơn hàng")]),t._v(" "),a("div",{staticClass:"page-actions"},[a("a",{staticClass:"button",attrs:{href:t.configUrl}},[t._v("Cài đặt")]),t._v(" "),a("router-link",{staticClass:"button",attrs:{to:{name:"pickups"}}},[t._v("\n        Điểm lấy hàng\n      ")])],1)]),t._v(" "),a("list-table",{attrs:{loading:t.loading,rows:t.items,columns:t.columns,"show-cb":!0,actions:t.actions,"bulk-actions":[],"action-column":"shop_name","total-items":t.pagination.total,"total-pages":t.pagination.total_page,"per-page":t.pagination.items_per_page,"current-page":t.pagination.current_page},on:{pagination:t.goToPage,"action:click":t.onActionClick,"bulk:click":t.onBulkAction},scopedSlots:t._u([{key:"id",fn:function(e){return[t._v(" "+t._s(t.orderId(e.row))+" ")]}},{key:"ship_address",fn:function(e){return[t._v("\n      "+t._s(t.orderShipTo(e.row))+"\n    ")]}},{key:"date_created",fn:function(e){return[t._v("\n      "+t._s(t.orderMeta(e.row)._gs_send_at)+"\n    ")]}},{key:"total",fn:function(e){return[t.orderMeta(e.row)._gs_fee?a("span",[t._v("\n        Phí: "+t._s(t.formatCurrency(t.orderMeta(e.row)._gs_fee))+"\n      ")]):t._e(),t._v(" "),a("br"),t._v(" "),t.orderMeta(e.row)._gs_cod?a("span",[t._v("\n        COD: "+t._s(t.formatCurrency(t.orderMeta(e.row)._gs_cod))+"\n      ")]):t._e()]}},{key:"carrier",fn:function(e){return[t._v("\n      "+t._s(t.orderMeta(e.row)._gs_carrier)+"\n    ")]}},{key:"tracking",fn:function(e){return[t.orderMeta(e.row)._gs_code?a("span",[t._v("Mã Goship: "+t._s(t.orderMeta(e.row)._gs_code))]):t._e(),t._v(" "),a("br"),t._v(" "),t.orderMeta(e.row)._gs_tracking_number?a("span",[t._v("Mã tracking: "+t._s(t.orderMeta(e.row)._gs_tracking_number))]):t._e()]}},{key:"status",fn:function(e){return[t._v("\n      "+t._s(t.orderMeta(e.row)._gs_status_name)+" "),a("br")]}},{key:"action",fn:function(e){return[!t.orderMeta(e.row)._gs_code||t.orderMeta(e.row)._gs_code&&914==t.orderMeta(e.row)._gs_status?a("button",{staticClass:"button",on:{click:function(a){return t.sendShipment(e.row)}}},[t._v("\n        Gửi đơn\n      ")]):t._e(),t._v(" "),t.orderMeta(e.row)._gs_code?a("button",{staticClass:"button",on:{click:function(a){return t.detailShipment(e.row)}}},[t._v("\n        Chi tiết\n      ")]):t._e(),t._v(" "),t.orderMeta(e.row)._gs_code?a("button",{staticClass:"button",on:{click:function(a){return t.printShipment(e.row)}}},[t._v("\n        In\n      ")]):t._e(),t._v(" "),t.orderMeta(e.row)._gs_code&&914!=t.orderMeta(e.row)._gs_status?a("button",{staticClass:"button delete-button",on:{click:function(a){return t.cancelShipment(e.row)}}},[t._v("\n        Hủy\n      ")]):t._e()]}}])},[t._v(" "),t._v(" "),t._v(" "),t._v(" "),t._v(" "),t._v(" "),t._v(" "),t._v(" "),a("template",{slot:"filters"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.filter.search,expression:"filter.search"}],attrs:{type:"text"},domProps:{value:t.filter.search},on:{input:function(e){e.target.composing||t.$set(t.filter,"search",e.target.value)}}}),t._v(" "),a("button",{staticClass:"button",on:{click:t.loadItems}},[t._v("Tìm kiếm")])])],2),t._v(" "),a("div",{attrs:{id:"send-shipment-dialog",title:"Gửi đơn hàng"}},[a("send-shipment-form",{ref:"send-shipment-form",on:{success:t.submitSendShipment}})],1),t._v(" "),a("div",{attrs:{id:"shipment-delete-confirm",title:"Hủy đơn hàng"}},[a("p",[a("span",{staticClass:"ui-icon ui-icon-alert",staticStyle:{float:"left",margin:"12px 12px 20px 0"}}),t._v("\n      Bạn chắc chắn muốn hủy đơn hàng\n      "),t.current?a("span",[t._v(t._s(t.orderMeta(t.current)._gs_code))]):t._e(),t._v("?\n    ")])]),t._v(" "),a("div",{attrs:{id:"detail-shipment-dialog",title:"Chi tiết vận đơn"}},[a("detail-shipment",{ref:"detail-shipment"})],1)],1)}),[],!1,null,"3151405a",null).exports},data:()=>({}),mounted(){}}),B=Object(n.a)(P,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"home"},[e("order")],1)}),[],!1,null,"78d5ec12",null).exports;Object(w.c)("required",C.b),Object(w.d)("vi",x);const L={shop_name:"",name:"",phone:"",city_code:"",district_code:"",ward_id:"",street:"",full_street:"",default:!0};var O={name:"PickupForm",props:[],components:{Select2:b,ValidationProvider:w.b,ValidationObserver:w.a},data:()=>({data:{...L},cities:[],districts:[],wards:[]}),methods:{async submit(){if(!await this.$refs.observer.validate())return void alert("Vui lòng kiểm tra thông tin cần nhập!");let t=this.$refs.city_code.options[this.$refs.city_code.selectedIndex].text,e=this.$refs.district_code.options[this.$refs.district_code.selectedIndex].text,a=this.$refs.ward_id.options[this.$refs.ward_id.selectedIndex].text;this.data.full_street=`${this.data.street}, ${a}, ${e}, ${t}`,this.$emit("success",this.data)},loadDistrict(){this.data.city_code?m.districts(this.data.city_code,t=>{this.districts=t}):this.districts=[]},loadCity(){m.cities(t=>{this.cities=t})},loadWard(){this.data.district_code?m.wards(this.data.district_code,t=>{this.wards=t}):this.wards=[]}},created(){this.loadCity(),this.$on("submit",()=>{this.submit()}),this.$on("init",t=>{t.default=1==t.default,this.data={...t},this.data.district_code&&this.loadDistrict(),this.data.district_code&&this.loadWard()}),this.$on("reset",()=>{this.data={...L},this.districts=[],this.wards=[]})}},N=(a(27),Object(n.a)(O,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"pickup-form"},[a("div",{staticClass:"form-wrap"},[a("ValidationObserver",{ref:"observer",scopedSlots:t._u([{key:"default",fn:function(e){e.invalid;var i=e.passes;return[a("form",{staticClass:"validate",on:{submit:function(e){return e.preventDefault(),i(t.submit)}}},[a("div",{staticClass:"form-field"},[a("label",[t._v("Tên shop")]),t._v(" "),a("ValidationProvider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.errors;return[a("input",{directives:[{name:"model",rawName:"v-model",value:t.data.shop_name,expression:"data.shop_name"}],attrs:{name:"Tên shop",type:"text"},domProps:{value:t.data.shop_name},on:{input:function(e){e.target.composing||t.$set(t.data,"shop_name",e.target.value)}}}),t._v(" "),a("span",{staticClass:"validate-error"},[t._v(t._s(i[0]))])]}}],null,!0)})],1),t._v(" "),a("div",{staticClass:"form-field"},[a("label",[t._v("Người liên hệ")]),t._v(" "),a("ValidationProvider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.errors;return[a("input",{directives:[{name:"model",rawName:"v-model",value:t.data.name,expression:"data.name"}],attrs:{name:"Tên người liên hệ",type:"text"},domProps:{value:t.data.name},on:{input:function(e){e.target.composing||t.$set(t.data,"name",e.target.value)}}}),t._v(" "),a("span",{staticClass:"validate-error"},[t._v(t._s(i[0]))])]}}],null,!0)})],1),t._v(" "),a("div",{staticClass:"form-field"},[a("label",[t._v("Điện thoại liên hệ")]),t._v(" "),a("ValidationProvider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.errors;return[a("input",{directives:[{name:"model",rawName:"v-model",value:t.data.phone,expression:"data.phone"}],attrs:{name:"Số điện thoại người liên hệ",type:"text"},domProps:{value:t.data.phone},on:{input:function(e){e.target.composing||t.$set(t.data,"phone",e.target.value)}}}),t._v(" "),a("span",{staticClass:"validate-error"},[t._v(t._s(i[0]))])]}}],null,!0)})],1),t._v(" "),a("div",{staticClass:"form-field"},[a("label",[t._v("Tỉnh thành")]),t._v(" "),a("ValidationProvider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.errors;return[a("select",{directives:[{name:"model",rawName:"v-model",value:t.data.city_code,expression:"data.city_code"}],ref:"city_code",staticStyle:{width:"100%"},attrs:{name:"Tỉnh thành"},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.data,"city_code",e.target.multiple?a:a[0])},t.loadDistrict]}},[a("option",{attrs:{value:""}},[t._v("Chọn tỉnh thành")]),t._v(" "),t._l(t.cities,(function(e){return a("option",{key:e.id,domProps:{value:e.id}},[t._v("\n                "+t._s(e.name)+"\n              ")])}))],2),t._v(" "),a("span",{staticClass:"validate-error"},[t._v(t._s(i[0]))])]}}],null,!0)})],1),t._v(" "),a("div",{staticClass:"form-field"},[a("label",[t._v("Quận huyện")]),t._v(" "),a("ValidationProvider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.errors;return[a("select",{directives:[{name:"model",rawName:"v-model",value:t.data.district_code,expression:"data.district_code"}],ref:"district_code",staticStyle:{width:"100%"},attrs:{disabled:!t.districts.length,name:"Quận huyện"},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.data,"district_code",e.target.multiple?a:a[0])},t.loadWard]}},[a("option",{attrs:{value:""}},[t._v("Chọn quận huyện")]),t._v(" "),t._l(t.districts,(function(e){return a("option",{key:e.id,domProps:{value:e.id}},[t._v("\n                "+t._s(e.name)+"\n              ")])}))],2),t._v(" "),a("span",{staticClass:"validate-error"},[t._v(t._s(i[0]))])]}}],null,!0)})],1),t._v(" "),a("div",{staticClass:"form-field"},[a("label",[t._v("Phường xã")]),t._v(" "),a("ValidationProvider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.errors;return[a("select",{directives:[{name:"model",rawName:"v-model",value:t.data.ward_id,expression:"data.ward_id"}],ref:"ward_id",staticStyle:{width:"100%"},attrs:{disabled:!t.wards.length,name:"Phường xã"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.data,"ward_id",e.target.multiple?a:a[0])}}},[a("option",{attrs:{value:""}},[t._v("Chọn phường xã")]),t._v(" "),t._l(t.wards,(function(e){return a("option",{key:e.id,domProps:{value:e.id}},[t._v("\n                "+t._s(e.name)+"\n              ")])}))],2),t._v(" "),a("span",{staticClass:"validate-error"},[t._v(t._s(i[0]))])]}}],null,!0)})],1),t._v(" "),a("div",{staticClass:"form-field"},[a("label",[t._v("Địa chỉ")]),t._v(" "),a("ValidationProvider",{attrs:{rules:"required"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.errors;return[a("input",{directives:[{name:"model",rawName:"v-model",value:t.data.street,expression:"data.street"}],attrs:{name:"Địa chỉ",type:"text"},domProps:{value:t.data.street},on:{input:function(e){e.target.composing||t.$set(t.data,"street",e.target.value)}}}),t._v(" "),a("span",{staticClass:"validate-error"},[t._v(t._s(i[0]))])]}}],null,!0)})],1),t._v(" "),a("div",{staticClass:"form-field"},[a("label",[t._v("Mặc định")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.data.default,expression:"data.default"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.data.default)?t._i(t.data.default,null)>-1:t.data.default},on:{change:function(e){var a=t.data.default,i=e.target,s=!!i.checked;if(Array.isArray(a)){var n=t._i(a,null);i.checked?n<0&&t.$set(t.data,"default",a.concat([null])):n>-1&&t.$set(t.data,"default",a.slice(0,n).concat(a.slice(n+1)))}else t.$set(t.data,"default",s)}}})])])]}}])})],1)])}),[],!1,null,"436ea10e",null).exports),R={name:"pickups",components:{ListTable:l.a,PickupForm:N},data:()=>({loading:!1,items:[],current:null,pagination:{total:1,items_per_page:25,total_page:1,current_page:1},columns:{shop_name:{label:"Tên shop"},name:{label:"Người liên hệ"},phone:{label:"Điện thoại liên hệ"},full_street:{label:"Địa chỉ"},default:{label:"Mặc định"}},actions:[{key:"edit",label:"Sửa"},{key:"trash",label:"Xóa"}]}),created(){this.loadItems()},mounted(){this.jQuery=jQuery,this.$nextTick(()=>{jQuery("#pickup-create-dialog").dialog({dialogClass:"wp-dialog",width:400,modal:!0,autoOpen:!1,closeOnEscape:!0,buttons:{"Tạo mới":()=>{this.$refs["create-form"].$emit("submit")},"Đóng":function(){jQuery(this).dialog("close")}}}),jQuery("#pickup-update-dialog").dialog({dialogClass:"wp-dialog",width:400,modal:!0,autoOpen:!1,closeOnEscape:!0,buttons:{"Cập nhật":()=>{this.$refs["update-form"].$emit("submit")},"Đóng":function(){jQuery(this).dialog("close")}}}),jQuery("#pickup-delete-confirm").dialog({dialogClass:"wp-dialog",width:400,modal:!0,autoOpen:!1,closeOnEscape:!0,buttons:{"Xóa":()=>{this.submitDelete(this.current)},"Đóng":function(){jQuery(this).dialog("close")}}})})},methods:{loadItems(){let t=this;t.loading=!0,f.getByQuery({page:this.pagination.current_page,per_page:this.pagination.items_per_page},e=>{t.loading=!1,t.items=e.data,t.pagination=e.pagination})},submitCreate(t){f.create(t,t=>{jQuery("#pickup-create-dialog").dialog("close"),this.pagination.current_page=1,this.loadItems()})},submitUpdate(t){t.id&&f.update(t.id,t,t=>{jQuery("#pickup-update-dialog").dialog("close"),this.loadItems()})},submitDelete(t){f.delete(t.id,[],t=>{jQuery("#pickup-delete-confirm").dialog("close"),this.pagination.current_page=1,this.loadItems()})},doEdit(t){this.current=t,this.$refs["update-form"].$emit("init",t),jQuery("#pickup-update-dialog").dialog("open")},doDelete(t){this.current=t,jQuery("#pickup-delete-confirm").dialog("open")},onActionClick(t,e){switch(console.log(t,e),t){case"edit":this.doEdit(e);break;case"trash":this.doDelete(e);break;default:return}},onBulkAction(t,e){if("trash"===t){let t=[];e.forEach(e=>{t.push(jQuery.ajax({url:WEB_GLOBAL_JS_VARIABLES.res_url+"goship/v1/pickups/"+e,type:"DELETE"}))}),jQuery.when(...t).then(t=>{this.pagination.current_page=1,this.loadItems()})}},goToPage(t){this.pagination.current_page=t,this.loadItems()}}},T=Object(n.a)(R,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"pickup"},[a("div",{staticClass:"page-header"},[a("div",[a("h1",{staticClass:"wp-heading-inline"},[t._v("Goship - Điểm lấy hàng")]),t._v(" "),a("button",{staticClass:"page-title-action",on:{click:function(){t.jQuery("#pickup-create-dialog").dialog("open")}}},[t._v("\n        Thêm mới\n      ")])]),t._v(" "),a("div",{staticClass:"page-actions"},[a("router-link",{staticClass:"button",attrs:{to:{name:"home"}}},[t._v("\n        Đơn hàng\n      ")])],1)]),t._v(" "),a("list-table",{attrs:{loading:t.loading,rows:t.items,columns:t.columns,"show-cb":!0,actions:t.actions,"bulk-actions":[{key:"trash",label:"Xóa"}],"action-column":"shop_name","total-items":t.pagination.total,"total-pages":t.pagination.total_page,"per-page":t.pagination.items_per_page,"current-page":t.pagination.current_page},on:{pagination:t.goToPage,"action:click":t.onActionClick,"bulk:click":t.onBulkAction},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.default?a("span",{staticClass:"dashicons dashicons-yes"}):a("span",[t._v("   ")])]}}])},[t._v(" "),a("template",{slot:"filters"})],2),t._v(" "),a("div",{attrs:{id:"pickup-create-dialog",title:"Thêm mới điểm lấy hàng"}},[a("pickup-form",{ref:"create-form",on:{success:t.submitCreate}})],1),t._v(" "),a("div",{attrs:{id:"pickup-update-dialog",title:"Sửa điểm lấy hàng"}},[a("pickup-form",{ref:"update-form",on:{success:t.submitUpdate}})],1),t._v(" "),t._m(0)],1)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"pickup-delete-confirm",title:"Xóa điểm lấy hàng"}},[e("p",[e("span",{staticClass:"ui-icon ui-icon-alert",staticStyle:{float:"left",margin:"12px 12px 20px 0"}}),this._v("\n      Bạn chắc chắn muốn xóa?\n    ")])])}],!1,null,null,null).exports;i.a.use(o.a);var V=new o.a({routes:[{path:"/",name:"home",component:B},{path:"/pickups",name:"pickups",component:T}]});var I=function(t){var e=jQuery;let a=e("#toplevel_page_"+t),i=window.location.href,s=i.substr(i.indexOf("admin.php"));a.on("click","a",(function(){var t=e(this);e("ul.wp-submenu li",a).removeClass("current"),t.hasClass("wp-has-submenu")?e("li.wp-first-item",a).addClass("current"):t.parents("li").addClass("current")})),e("ul.wp-submenu a",a).each((function(t,a){e(a).attr("href")!==s||e(a).parent().addClass("current")}))};a(28),a(14),a(16),a(29);i.a.config.productionTip=!1,console.log(WEB_GLOBAL_JS_VARIABLES),i.a.mixin({computed:{configUrl:()=>WEB_GLOBAL_JS_VARIABLES.admin_url+"/admin.php?page=wc-settings&tab=shipping&section=woo_goship"},methods:{formatNumber(t,e=2,a=".",i=","){e=Math.abs(e),e=isNaN(e)?2:e;const s=t<0?"-":"";let n=parseInt(t=Math.abs(Number(t)||0).toFixed(e)).toString(),r=n.length>3?n.length%3:0;return s+(r?n.substr(0,r)+i:"")+n.substr(r).replace(/(\d{3})(?=\d)/g,"$1"+i)+(e?a+Math.abs(t-n).toFixed(e).slice(2):"")},formatCurrency(t){return this.formatNumber(t,0)+" đ"}}}),new i.a({el:"#vue-admin-app",router:V,render:t=>t(r)}),I(WEB_GLOBAL_JS_VARIABLES.text_domain)}],[[32,0,1]]]);